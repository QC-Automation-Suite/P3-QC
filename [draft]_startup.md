# QC Automation Suite - Startup

---
---

## Definitions [TEMP]

- `OrganizationA`: The [Client] Organization [FIX]
- `TenantA`: The Production Tenant in Organization A

---
---

## Software Prerequisites

- Make sure you are running Windows 10 with the latest updates installed
- Microsoft Excel (Office 365 Subscription)
- Microsoft Word (Office 365 Subscription)
- UiPath Studio ([_download link_](https://docs.uipath.com/installation-and-upgrade/docs/studio-install-studio))
	* Must be connected to the _Production Orchestrator Tenant_ `TenantA` in the _UiPath Organization_ `OrganizationA`. [VERIFY]
		- __ie__ to the _Orchestrator URL_: `https://cloud.uipath.com/[ OrganizationA ]/[ TenantA ]/orchestrator_/`. [VERIFY]
- UiPath Assistant
	* Must be connected to the _Production Orchestrator Tenant_ `TenantA` in the _UiPath Organization_ `OrganizationA`. [VERIFY]
		- __ie__ to the _Orchestrator URL_: `https://cloud.uipath.com/[ OrganizationA ]/[ TenantA ]/orchestrator_/`. [VERIFY]
- Git ([_installation guide_](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git))
- Chrome Browser ([_download link_](https://www.google.com/chrome/))
- Uipath Chrome Browser Extension
	* UiPath Home -> Tools -> UiPath Extensions -> Chrome Extension
- Adobe Acrobat Reader DC ([_download link_](https://get.adobe.com/reader/))

---
---

## Clone the source Repository from GitHub

1. Open up Command Prompt and navigate to a desired local directory
2. In the Command Prompt, run:
3. git clone https://github.com/QC-Automation-Suite/P3-QC

`P3-QC Repo` contains:
- `QcSchedulerAssistant` UiPath Studio Process.
- `Report.Helper.Dispatcher` UiPath Studio Process.
- `Report.Helper.Performer` UiPath Studio Process.
- `P0Analyzer` UiPath Studio Process.
- `QcAutomationSuite.uiapp` UiPath App from the folder: `./QcAutomationSuite.uiapp/`.
- `QCSchedule.xlsx` Excel file in the folder: `./Data/QcSchedulerAssistant/`
- [VERIFY]`Dummy QC Schedule Copy.xlsx` Excel file in the folder: `./Data/QcReportHelper/`
- [VERIFY]`Dummy_Survey_Responses.xlsx` Excel file in the folder: `./Data/QcReportHelper/`

---
---

## Automation and UiPath App Setup in UiPath Organization (cloud.uipath.com)

There are 3 Automations to deploy to `TenantA`:
1. _QC Scheduler Assistant_, consisting of the Process: `QcSchedulerAssistant`.
2. _QC Report Helper_, consisting of the Processes: `Report.Helper.Dispatcher`, and `Report.Helper.Performer`.
3. _P0 Analyzer_, consisting of the Process: `P0Analyzer`.

---

### Configure the Folder-structure and Folder resources in `TenantA`

Create an appropriate Folder-structure to house the Processes for the 3 Automations.
> __Recommended Folder-structure and Process-distribution (all at Tenant-level)__:
> - `QcSchedulerAssistant` Folder to house the Process: `QcSchedulerAssistant`.
> - `QcReportHelper` Folder to house the Processes: `Report.Helper.Dispatcher`, and `Report.Helper.Performer`.
> - `P0Analyzer` Folder to house the Process: `P0Analyzer`.

Each of these 3 Automations make use of the following Folder resources:
1. _QC Scheduler Assistant_:
	- `Schedules` : Storage Bucket
		* Configuration: Upload the file `QCSchedule.xlsx` from the cloned `P3-QC` Repo folder `./Data/QcSchedulerAssistant`.
    	- `Gmail` : Asset of _Credential_ type
        	* Configuration: Enter the email id and password of the gmail account that is to be used to send a copy of the final PDF report generated by this automation. [unsecure app access].
2. _QC Report Helper_:
	- [VERIFY] `Excel Sheets` : Storage Bucket
		* Configuration: Upload the following files from the cloned `P3-QC` Repo folder `./Data/QcReportHelper/`:
			- [VERIFY] `Dummy QC Schedule Copy.xlsx`
			- [VERIFY] `Dummy_Survey_Responses.xlsx`
	- `JustAQueue` : Queue
		* Configuration:
			- Select `Yes` for the property: `Auto Retry`.
			- Enter `1` for the property: `Max # of retries`.
	- `Report Helper Queue Trigger` : Trigger of _Queue_ type.
		* Configuration:
			- Select the `Report.Helper.Performer` Process for the `Process Name` property.
			- Set the `Job priority` property to `Inherited`.
			- Set the `Runtime license` property to `Production (Unattended)`.
			- Select the Queue `JustAQueue` into the `Queue` property.
			- Enter `1` for the property: `Minimum number of items to trigger the first job`.
			- Enter `10` for the property: `Maximum number of pending and running jobs allowed simultaneously`.
			- Enter `1` for the property: `Another job is triggered for each x new item(s)`.
			- In the `Execution Target` property-section:
				* Select the appropriate Tenant User `Account` and `Machine` that have been allocated an _Unattended License_.
3. _P0 Analyzer_:
	- `Repos` : Storage Bucket
	- `Reports` : Storage Bucket
	- `OutputFiles` : StorageBucket
	- `EmailCred` : Asset of _Credential_ type.
		* Configuration: Enter the email id and password of the gmail account that is to be used to send a copy of the final PDF report generated by this automation. [unsecure app access].
	- [VERIFY] `TrainerP0Wiki` : Asset of _Text_ type.

> __Recommended setup for these resources in the Folder-structure__:
> - Put the above-mentioned resources for the _QC Scheduler Assistant_ automation(s) into the `QcSchedulerAssistant` Folder:
> - Put the above-mentioned resources for the _QC Report Helper_ automation(s) into the `QcReportHelper` Folder:
> - Put the above-mentioned resources for the _P0 Analyzer_ automation(s) into the `P0Analyzer` Folder:

---

### Publish the Processes to Tenant

1. Publish each of the 4 Processes to `TenantA` from UiPath Studio as Packages.
2. Verify that the 4 Processes have been published to `TenantA` as 4 Packages of the same name.
3. Add the 4 Processes appropriately into the Folder-structure (refer to the Folder-structure and Process-distribution suggested above).

---

### Configure the `QC Automation Suite` _UiPath App_ into the `OrganizationA`

1. Go to `Apps` in the cloud.uipath.com when logged into `OrganizationA`
2. Import the _UiPath App_ (`QCAutomationSuite.uiapp`) from the cloned `P3-QC` folder `./QcAutomationSuiteWebApp/`:
	- Click `Build a new app`.
	- Give the `Name`: "...".
	- Click `Import from file`.
	- Navigate to `.uiapp` file : ("QCAutomationSuite.uiapp").
	- Click `Create`.
3. Configure Orchestrator Dependencies:
	- In the Left Panel (App Explorer(?)) [FIX],
		* Navigate to and expand the expandable menu item `Orchestrator`. It should have the Symbol: `!` in a Red Circle, next to it.
		* There should be four subitems, each corresponding to one of the 4 Processes, each with the same Symbol next to it: `!` in a Red Circle, next to it.
		* For each, right click on it.
			- Click `Replace`.
			- A Window pops up with two vertical panels: `Processes` and `Process Details`.
		* The `Processes` panel displays all of the Folders in `TenantA` as expandable menu items, with their respective Processes as sub items.
		* Locate and select the Matching Process in the appropriate Folder.
		* Click `Replace`.
4. Publish the _App_: In the top right corner, click `Publish`.

---
---

## Using the QcAutomationSuite _UiPath App_

---

### Run the QcAutomationSuite _UiPath App_ from _UiPath Assistant_
1. Open _UiPath Assitant_.
2. In the `Home` tab, navigate to the expandable section: `Apps`.
3. In this section, locate the item (App) with the name `QcAutomationSuite`.
4. Click `Run`. (_play_ button) [VERIFY]

---
### Entering Inputs into the Web App

Each of the automations require certain inputs to be entered by the user. These are:
- __Auditor Email__: This is the email address to which the PDF reports generated by any of the 3 automations is to be sent.
	* It is to be entered in an _input_ element of _text_ type (_textbox_). [FIX]
	* Must be provided before the execution of the `QC Report Helper`, `QC Scheduler`, and `P0 Analyzer` automations.
- __Auditor Name__: The name of the Auditor (user) executing the automations from this web app.
	* It is to be selected in an _input_ element of _select_ type (_single selection dropdown_). [FIX]
	* Must be selected before the execution of the `QC Report Helper` and `QC Scheduler` automations.
- __Project 0 Requirements URL__: This is the GitHub URL to the _ReadMe.md_ file with project requirements in the _Project 0_ for which student repository submissions are to be analyzed (assisted by `P0Analyzer`).
	* Example: `https://github.com/[ Batch Organization ]/trainer-code/wiki/P0-Requirements.md`.
	* This _ReadMe.md_ must contain a _MVP Features_ section.
	* It is to be entered in an _input_ element of _text_ type (_textbox_). [FIX]
	* Must be provided before the execution of the `P0 Analyzer` automation.
- __Repos List__: This is a `.xlsx` file containing a table of all the Associate GitHub repositories to be analyzed.
	* The file must consist of a single _sheet_ containing a single table with the columns: `Name`, `UserName`, and `Repo URL`.
	* It is to be uploaded using a _File Selecter_ element, followed by clicking the button `Upload to Storage Bucket`. [FIX][VERIFY]
	* Must be provided before the execution of the `P0 Analyzer` automation.

---

### Executing the Automations

The execution of each of these 3 automations (`P0 Analyzer`, `QC Report Helper`, `QC Scheduler`) is mapped to a _Button_ element. Clicking a button results in the execution of the corresponding automation via UiPath Assistant (in tandem with Orchestrator). The status of the execution is displayed at the bottom of the page.

---
---


##
LABELS [TEMP]
- [VERIFY]
- [FIX]
- (?)
- [TEMP]
